import{a as e,j as i,b,r as o,q as y,d as N}from"./app-8f101c97.js";import{A as g}from"./AuthenticatedLayout-219936d1.js";import{P as f}from"./PrimaryButton-9840ceac.js";import{M as w}from"./Modal-f31af360.js";import"./ApplicationLogo-d6bf06fd.js";import"./transition-c72f98cb.js";function A({currentUser:a,showModal:t,setShowModal:h,setRespUser:m}){let n=null,c=!1;function r(){h(!1),n=null,c=!1}function s(){n===null&&!c?$.notify("No action to apply!"):axios.put("/users/"+a.id,{newRole:n,checked:c}).then(d=>{d.status===200?(m(d.data),$.notify("Changed successfully","success"),r()):$.notify("An error occurred")}).catch(d=>{console.log(d),$.notify(d)})}return e("div",{children:e(w,{onClose:r,show:t,children:i("div",{className:"px-6 py-6",children:[i("div",{className:"mb-4",children:[e("span",{className:"mr-2",children:"Name: "}),e("span",{children:a.firstName+" "+(a.middleName??"")+" "+a.lastName})]}),i("div",{className:"mb-4",children:[e("span",{className:"mr-2",children:"Email: "}),e("span",{children:a.email})]}),i("div",{className:"mb-4",children:[e("span",{className:"mr-2",children:"Role: "}),e("span",{className:"mr-4",children:a.role}),e("label",{className:"mr-4",children:"Change Role:"}),i("select",{defaultValue:a.role,onChange:d=>{n=d.target.value},children:[e("option",{value:"admin",children:"Admin"}),e("option",{value:"alumni",children:"Alumni"})]})]}),i("div",{className:"mb-4",children:[e("span",{className:"mr-2",children:"Status: "}),e("span",{className:"mr-8",children:a.deleted_at!==null?"Deactivated":a.role==="provisional"?"Not Approved":"Active"}),e("input",{type:"checkbox",defaultChecked:!1,onChange:d=>{c=d.target.checked}}),e("label",{className:"ml-3",children:a.deleted_at!==null?"Activate":"Deactivate"})]}),i("div",{className:"mb-4",children:[e("span",{className:"mr-2",children:"Email Verified: "}),e("span",{children:a.email_verified_at===null?"No":"Yes"})]}),i("div",{children:[e(f,{className:"mr-6",onClick:()=>{s()},children:"Apply"}),e(f,{className:"bg-red-600 hover:bg-red-600",onClick:()=>{r()},children:"Cancel"})]})]})})})}function C({fetchedUsers:a}){const[t,h]=o.useState(Object.fromEntries(new Map(a.map(l=>[l.id,l])))),[m,n]=o.useState(!1),[c,r]=o.useState(a[0]),[s,d]=o.useState(null),p=y().props.auth.user;o.useEffect(()=>{s!==null&&h({...t,[s.id]:s})},[s]);const u="viewUsersTable";$(document).ready(function(){$("#"+u).DataTable({columnDefs:[{searchable:!1,targets:[5,6]}],bDestroy:!0})});function v(l){r(l),n(!0)}return i("div",{children:[e(A,{showModal:m,setShowModal:n,currentUser:c,setRespUser:d}),i("table",{id:u,className:"cell-border hover",children:[e("thead",{children:i("tr",{children:[e("th",{children:"Name"}),e("th",{children:"Email"}),e("th",{children:"Role"}),e("th",{children:"Status"}),e("th",{children:"Email Verified"}),e("th",{}),e("th",{}),e("th",{})]})}),e("tbody",{children:Object.values(t).map(l=>i("tr",{children:[e("td",{children:l.firstName+" "+(l.middleName??"")+" "+l.lastName}),e("td",{children:l.email}),e("td",{children:l.role}),e("td",{children:l.deleted_at!==null?"Deactivated":"Active"}),e("td",{children:l.email_verified_at===null?"No":"Yes"}),e("td",{children:e(N,{href:p.id===l.id?"/profile":"/profile/"+l.id,children:e("u",{children:"profile"})})}),e("td",{children:e(N,{href:p.id===l.id?"/academic":"/academic/"+l.id,onFinish:()=>{window.location.pathname==="/users"&&$.notify("Academic info not found!")},children:e("u",{children:"academic"})})}),e("th",{children:e(f,{onClick:()=>{v(l)},children:"EDIT"})})]},l.id))})]})]})}function M({auth:a,users:t}){return i(g,{user:a.user,children:[e(b,{title:"Users"}),e("div",{className:"mx-auto p-4 sm:p-6 lg:p-8 bg-white",children:e(C,{fetchedUsers:t})})]})}export{M as default};
